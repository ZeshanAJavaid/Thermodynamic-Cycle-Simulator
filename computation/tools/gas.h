#pragma once
#include <vector>
#include <cmath>

using namespace std;


struct Air_Mixture
{

    vector<vector<double>> N2 = {{28.01348, 78.084}, 
                {2.95257626E+00, 1.39690057E-03, -4.92631691E-07, 7.86010367E-11, -4.60755321E-15, -9.23948645E+02, 5.87189252E+00},
                {3.53100528E+00, -1.23660987E-04, -5.02999437E-07, 2.43530612E-09, -1.40881235E-12, -1.04697628E+03, 2.96747468E+00}};

    vector<vector<double>>O2 = {{31.99880, 20.946},
                {3.66096083E+00, 6.56365523E-04, -1.41149485E-07, 2.05797658E-11, -1.29913248E-15, -1.21597725E+03, 3.41536184E+00},
                {3.78245636E+00, -2.99673415E-03, 9.84730200E-06, -9.68129508E-09, 3.24372836E-12, -1.06394356E+03, 3.65767573E+00}};

    vector<vector<double>> Ar = {{39.94800, 0.9340},
                {2.50000000E+00, 0.0, 0.0, 0.0, 0.0, -7.45375000E+02, 4.37967491E+00},
                {2.50000000E+00, 0.0, 0.0, 0.0, 0.0, -7.45375000E+02, 4.37967491E+00}};

    vector<vector<double>> CO2 = {{44.00980, 0.0407},
                {4.63659493E+00, 2.74131991E-03, -9.95828531E-07, 1.60373011E-10, -9.16103468E-15, -4.90249341E+04, -1.93534855E+00},
                {2.35677352E+00, 8.98459677E-03, -7.12356269E-06, 2.45919022E-09, -1.43699548E-13, -4.83719697E+04, 9.90105222E+00}};

    vector<vector<double>> Ne = {{20.17970, 0.001818},
                {2.50000000E+00, 0.0, 0.0, 0.0, 0.0, -7.45375000E+02, 3.35532272E+00},
                {2.50000000E+00, 0.0, 0.0, 0.0, 0.0, -7.45375000E+02, 3.35532272E+00}};

    vector<vector<double>> He = {{4.00260, 0.000524},
                {2.50000000E+00, 0.0, 0.0, 0.0, 0.0, -7.45375000E+02, 9.28724724E-01},
                {2.50000000E+00, 0.0, 0.0, 0.0, 0.0, -7.45375000E+02, 9.28724724E-01}};

    vector<vector<double>> CH4 = {{16.04276, 0.00018},
                {1.63552643E+00, 1.00842795E-02, -3.36916254E-06, 5.34958667E-10, -3.15518833E-14, -1.00056455E+04, 9.99313326E+00},
                {5.14987613E+00, -1.36709788E-02, 4.91800599E-05, -4.84743026E-08, 1.66693956E-11, -1.02466476E+04, -4.64130376E+00}};

    vector<vector<double>> Kr = {{83.80000, 0.000114},
                {2.50000000E+00, 0.0, 0.0, 0.0, 0.0, -7.45375000E+02, 5.49095651E+00},
                {2.50000000E+00, 0.0, 0.0, 0.0, 0.0, -7.45375000E+02, 5.49095651E+00}};

    vector<vector<double>> H2 = {{2.01588, 0.000055},
                {2.93286579E+00, 8.26607967E-04, -1.46402335E-07, 1.54100359E-11, -6.88804432E-16, -8.13065597E+02, -1.02432887E+00},
                {2.34433112E+00, 7.98052075E-03, -1.94781510E-05, 2.01572094E-08, -7.37611761E-12, -9.17935173E+02, 6.83010238E-01}};
        };


class AirProperties
{
    private:
        Air_Mixture air;
        const double R = 8.31446261815324;
        double molar_mass;
        vector<double> polynomial_consts_low;
        vector<double> polynomial_consts_high;
    public:
        AirProperties();
        double get_cp(double) const;
        double get_cv(double) const;
        double get_gamma(double) const;
        double get_enthalpy(double) const;
        double get_internal_energy(double) const;
        double get_entropy(double) const;
        double get_R() const;
        vector<double> get_low_polynomials() const;
        vector<double> get_high_polynomials() const;
};